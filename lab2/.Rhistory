demo()
x = c(1,3)
y = c(1,3,7)
y
print(y)
source("C:/Users/albre/tdde07/lab2/Lab2_Assignment1.R", echo=TRUE)
source("C:/Users/albre/tdde07/lab2/Lab2_Assignment1.R", echo=TRUE)
setwd("C:/Users/albre/tdde07/lab2")
source("C:/Users/albre/tdde07/lab2/Lab2_Assignment1.R", echo=TRUE)
source("C:/Users/albre/tdde07/lab2/Lab2_Assignment1.R", echo=TRUE)
source("C:/Users/albre/tdde07/lab2/Lab2_Assignment1.R", echo=TRUE)
source("C:/Users/albre/tdde07/lab2/Lab2_Assignment1.R", echo=TRUE)
source("C:/Users/albre/tdde07/lab2/Lab2_Assignment1.R", echo=TRUE)
source("C:/Users/albre/tdde07/lab2/Lab2_Assignment1.R", echo=TRUE)
source("C:/Users/albre/tdde07/lab2/Lab2_Assignment1.R", echo=TRUE)
source("C:/Users/albre/tdde07/lab2/Lab2_Assignment1.R", echo=TRUE)
source("C:/Users/albre/tdde07/lab2/Lab2_Assignment1.R", echo=TRUE)
source("C:/Users/albre/tdde07/lab2/Lab2_Assignment1.R", echo=TRUE)
source("C:/Users/albre/tdde07/lab2/Lab2_Assignment1.R", echo=TRUE)
source("C:/Users/albre/tdde07/lab2/Lab2_Assignment1.R", echo=TRUE)
source("C:/Users/albre/tdde07/lab2/Lab2_Assignment1.R", echo=TRUE)
source("C:/Users/albre/tdde07/lab2/Lab2_Assignment1.R", echo=TRUE)
source("C:/Users/albre/tdde07/lab2/Lab2_Assignment1.R", echo=TRUE)
source("C:/Users/albre/tdde07/lab2/Lab2_Assignment1.R", echo=TRUE)
source("C:/Users/albre/tdde07/lab2/Lab2_Assignment1.R", echo=TRUE)
source("C:/Users/albre/tdde07/lab2/Lab2_Assignment1.R", echo=TRUE)
?rep
length(df_with_time$time)
source("C:/Users/albre/tdde07/lab2/Lab2_Assignment1.R", echo=TRUE)
source("C:/Users/albre/tdde07/lab2/Lab2_Assignment1.R", echo=TRUE)
u_n <- solve(t(x)%*%x + omega0)%*%(t(x)%*%x%*%beta_hat + omega0%*%u0)
View(omega0)
source("C:/Users/albre/tdde07/lab2/Lab2_Assignment1.R", echo=TRUE)
source("C:/Users/albre/tdde07/lab2/Lab2_Assignment1.R", echo=TRUE)
source("C:/Users/albre/tdde07/lab2/Lab2_Assignment1.R", echo=TRUE)
source("C:/Users/albre/tdde07/lab2/Lab2_Assignment1.R", echo=TRUE)
source("C:/Users/albre/tdde07/lab2/Lab2_Assignment1.R", echo=TRUE)
source("C:/Users/albre/tdde07/lab2/Lab2_Assignment1.R", echo=TRUE)
source("C:/Users/albre/tdde07/lab2/Lab2_Assignment1.R", echo=TRUE)
source("C:/Users/albre/tdde07/lab2/Lab2_Assignment1.R", echo=TRUE)
source("C:/Users/albre/tdde07/lab2/Lab2_Assignment1.R", echo=TRUE)
View(x)
sigma_post <- draw_sigma2(v_n, sigma2_n)
beta_post <- MASS::mvrnorm(u_n, sigma_post%*%soleve(omega_n))
source("C:/Users/albre/tdde07/lab2/Lab2_Assignment1.R", echo=TRUE)
source("C:/Users/albre/tdde07/lab2/Lab2_Assignment1.R", echo=TRUE)
View(sigma_post)
source("C:/Users/albre/tdde07/lab2/Lab2_Assignment1.R", echo=TRUE)
source("C:/Users/albre/tdde07/lab2/Lab2_Assignment1.R", echo=TRUE)
source("C:/Users/albre/tdde07/lab2/Lab2_Assignment1.R", echo=TRUE)
solve(omega_n)
beta_post <- MASS::mvrnorm(u_n, sigma_post[1]*solve(omega_n))
sigma_post <- draw_sigma2(v_n, sigma2_n)[1,1]
beta_post <- MASS::mvrnorm(u_n, sigma_post*solve(omega_n))
beta_post <- MASS::mvrnorm(u_n, (sigma_post*solve(omega_n)))
source("C:/Users/albre/tdde07/lab2/Lab2_Assignment1.R", echo=TRUE)
?par()
par(3)
par(mfrw=3)
par(mfrow=3)
hist(beta_post[1])
hist(beta_post[1,])
hist(beta_post[,1])
hist(beta_post)
hist(beta_post[0])
hist(beta_post[1])
hist(beta_post[2])
nDraws <- 10^3
temp <- vector(mode = "int", 10)
?vector
temp <- vector(mode = "integer", 10)
source("C:/Users/albre/tdde07/lab2/Lab2_Assignment1.R", echo=TRUE)
source("C:/Users/albre/tdde07/lab2/Lab2_Assignment1.R", echo=TRUE)
source("C:/Users/albre/tdde07/lab2/Lab2_Assignment1.R", echo=TRUE)
sigma_posts <- sample_sigma2s(v_n, sigma2_n, nDraws)
beta_posts <- sample_betas(u_n, sigma_posts, omega_n)
beta_posts <- sample_betas(u_n, sigma_posts, omega_n)
source("C:/Users/albre/tdde07/lab2/Lab2_Assignment1.R", echo=TRUE)
source("C:/Users/albre/tdde07/lab2/Lab2_Assignment1.R", echo=TRUE)
source("C:/Users/albre/tdde07/lab2/Lab2_Assignment1.R", echo=TRUE)
source("C:/Users/albre/tdde07/lab2/Lab2_Assignment1.R", echo=TRUE)
length(sigma_posts
)
source("C:/Users/albre/tdde07/lab2/Lab2_Assignment1.R", echo=TRUE)
source("C:/Users/albre/tdde07/lab2/Lab2_Assignment1.R", echo=TRUE)
source("C:/Users/albre/tdde07/lab2/Lab2_Assignment1.R", echo=TRUE)
source("C:/Users/albre/tdde07/lab2/Lab2_Assignment1.R", echo=TRUE)
hist(beta_posts[1,])
View(beta_posts)
temp[i,] <- MASS::mvrnorm(n= 1, u, (sigmas[i]*solve(omega_n)))
source("C:/Users/albre/tdde07/lab2/Lab2_Assignment1.R", echo=TRUE)
MASS::mvrnorm(n = 1, mu = u0, sigma*solve(omega0))
source("C:/Users/albre/tdde07/lab2/Lab2_Assignment1.R", echo=TRUE)
View(beta_posts)
source("C:/Users/albre/tdde07/lab2/Lab2_Assignment1.R", echo=TRUE)
source("C:/Users/albre/tdde07/lab2/Lab2_Assignment1.R", echo=TRUE)
source("C:/Users/albre/tdde07/lab2/Lab2_Assignment1.R", echo=TRUE)
source("C:/Users/albre/tdde07/lab2/Lab2_Assignment1.R", echo=TRUE)
source("C:/Users/albre/tdde07/lab2/Lab2_Assignment1.R", echo=TRUE)
nrow(df_with_time)
Y_big <- matrix(nrow = nDraws, ncol = nrow(df_with_time))
View(Y_big)
Y_big <- matrix(nrow = nDraws, ncol = nrow(df_with_time))
for (i in 1:Y(nrow(Y_big)))
{
Y[i] <- calc_temp(x, beta_posts, epsilon)
}
Y_big <- matrix(nrow = nDraws, ncol = nrow(df_with_time))
for (i in 1:Y(nrow(Y_big)))
{
Y_big[i] <- calc_temp(x, beta_posts, epsilon)
}
Y_big <- matrix(nrow = nDraws, ncol = nrow(df_with_time))
for (i in 1:nrow(Y_big))
{
Y_big[i] <- calc_temp(x, beta_posts, epsilon)
}
for (i in 1:nrow(Y_big))
{
Y_big[i] <- calc_temp(x, beta_posts[i,], epsilon)
}
View(Y_big)
for (i in 1:nrow(Y_big))
{
Y_big[i,] <- calc_temp(x, beta_posts[i,], epsilon)
}
View(Y_big)
median(Y_big)
median(Y_big[1,])
median(Y_big[,1])
median(Y_big[,1])
median() <- c(mode = "integer", 30)
median() <- c(mode = "integer", length = 30)
median() <- vector(mode = "integer", length = 30)
vector(mode = "integer", length = 30)
median <- vector(mode = "integer", length = 30)
median <- vector(mode = "integer", length = nrow(df_with_time))
low_perc <- median
up_perc <- median
for (i in 1:nrow(df_with_time))
{
median[i] <- median(Y[,i])
}
for (i in 1:nrow(df_with_time))
{
median[i] <- median(Y_big[,i])
}
median
?quantile
for (i in 1:nrow(df_with_time))
{
median[i] <- median(Y_big[,i])
low_perc <- quantile(Y_big[,i], 0.05)
up_perc <- quantile(Y_big[,i], 0.95)
}
source("C:/Users/albre/tdde07/lab2/Lab2_Assignment1.R", echo=TRUE)
plot(x = df_with_time$time, y=median)
plot(x = df_with_time$time, y=median)
plot(x = df_with_time$time, y=median)
plot(x = df_with_time$time, y=median)
dev.off()
plot(x = df_with_time$time, y=median)
plot(x = df_with_time$time, y=median, type = 'l')
points(y = df_with_time$temp)
points(y = df_with_time$temp, x = df_with_time$time)
points(y = df_with_time$temp, x = df_with_time$time, col = "red")
line(y = df_with_time$temp, x = df_with_time$time, col = "red")
lines(y = df_with_time$temp, x = df_with_time$time, col = "red")
lines(y = df_with_time$temp, x = df_with_time$time, col = "red")
plot(x = df_with_time$time, y=median, type = 'l')
lines(y = df_with_time$temp, x = df_with_time$time, col = "red")
plot(x = df_with_time$time, y=median, type = 'l', col = "blue")
points(y = df_with_time$temp, x = df_with_time$time, col = "grey")
lines(y = up_perc, x = df_with_time$time, col = "red")
lines(y = low_perc, x = df_with_time$time, col = "red")
source("C:/Users/albre/tdde07/lab2/Lab2_Assignment1.R", echo=TRUE)
plot(x = df_with_time$time, y=median, type = 'l', col = "blue"
ylab = "Temperature")
plot(x = df_with_time$time, y=median, type = 'l', col = "blue",
ylab = "Temperature")
plot(x = df_with_time$time, y=median, type = 'l', col = "blue",
ylab = "Temperature", xlab = "Time")
points(y = df_with_time$temp, x = df_with_time$time, col = "grey")
lines(y = up_perc, x = df_with_time$time, col = "red")
lines(y = low_perc, x = df_with_time$time, col = "red")
source("C:/Users/albre/tdde07/lab2/Lab2_Assignment1.R", echo=TRUE)
source("C:/Users/albre/tdde07/lab2/Lab2_Assignment1.R", echo=TRUE)
source("C:/Users/albre/tdde07/lab2/Lab2_Assignment1.R", echo=TRUE)
source("C:/Users/albre/tdde07/lab2/Lab2_Assignment1.R", echo=TRUE)
source("C:/Users/albre/tdde07/lab2/Lab2_Assignment1.R", echo=TRUE)
#Degrees of freedom when sampling from the invCHISQ.
v0 <- 10
source("C:/Users/albre/tdde07/lab2/Lab2_Assignment1.R", echo=TRUE)
x <- seq(0, 30, length = 1000)
df1 <- dchisq(x, df = 1)
df10 <- dchisq(x, df = 10)
df100 <- dchisq(x, df = 100)
plot(x, df1, type = "l", col = "blue", ylim = c(0, 0.4),
main = "Chi-square distributions with different degrees of freedom")
lines(x, df10, col = "red")
lines(x, df100, col = "green")
legend("topright", legend = c("df = 1", "df = 10", "df = 100"),
col = c("blue", "red", "green"), lty = 1, cex = 0.8)
x <- seq(0, 30, length = 1000)
df1 <- 5*dchisq(x, df = 1)
df10 <- 5*dchisq(x, df = 10)
df100 <- 5*dchisq(x, df = 100)
plot(x, df1, type = "l", col = "blue", ylim = c(0, 0.4),
main = "Chi-square distributions with different degrees of freedom")
lines(x, df10, col = "red")
lines(x, df100, col = "green")
legend("topright", legend = c("df = 1", "df = 10", "df = 100"),
col = c("blue", "red", "green"), lty = 1, cex = 0.8)
source("C:/Users/albre/tdde07/lab2/Lab2_Assignment1.R", echo=TRUE)
source("C:/Users/albre/tdde07/lab2/Lab2_Assignment1.R", echo=TRUE)
source("C:/Users/albre/tdde07/lab2/Lab2_Assignment1.R", echo=TRUE)
source("C:/Users/albre/tdde07/lab2/Lab2_Assignment1.R", echo=TRUE)
source("C:/Users/albre/tdde07/lab2/Lab2_Assignment1.R", echo=TRUE)
source("C:/Users/albre/tdde07/lab2/Lab2_Assignment1.R", echo=TRUE)
source("C:/Users/albre/tdde07/lab2/Lab2_Assignment1.R", echo=TRUE)
source("C:/Users/albre/tdde07/lab2/Lab2_Assignment1.R", echo=TRUE)
source("C:/Users/albre/tdde07/lab2/Lab2_Assignment1.R", echo=TRUE)
source("C:/Users/albre/tdde07/lab2/Lab2_Assignment1.R", echo=TRUE)
source("C:/Users/albre/tdde07/lab2/Lab2_Assignment1.R", echo=TRUE)
source("C:/Users/albre/tdde07/lab2/Lab2_Assignment1.R", echo=TRUE)
source("C:/Users/albre/tdde07/lab2/Lab2_Assignment1.R", echo=TRUE)
source("C:/Users/albre/tdde07/lab2/Lab2_Assignment1.R", echo=TRUE)
source("C:/Users/albre/tdde07/lab2/Lab2_Assignment1.R", echo=TRUE)
source("C:/Users/albre/tdde07/lab2/Lab2_Assignment1.R", echo=TRUE)
source("C:/Users/albre/tdde07/lab2/Lab2_Assignment1.R", echo=TRUE)
source("C:/Users/albre/tdde07/lab2/Lab2_Assignment1.R", echo=TRUE)
source("C:/Users/albre/tdde07/lab2/Lab2_Assignment1.R", echo=TRUE)
source("C:/Users/albre/tdde07/lab2/Lab2_Assignment1.R", echo=TRUE)
source("C:/Users/albre/tdde07/lab2/Lab2_Assignment1.R", echo=TRUE)
x_tilde <- beta[,2]
x_tilde <- beta_posts[,2]
x_tilde <- beta_posts[,3]
x_tilde <- -(beta_posts[,2]/beta_posts[,3])*0.5
hist(x_tilde, main="Histogram of beta0 posterior", xlab="beta0")
u_10  <- c(1, 80, -80, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0)
u_10  <- c(1, 80, -80, 0, 0, 0, 0, 0, 0, 0, 0, 0)
u_10  <- c(1, 80, -80, 0, 0, 0, 0, 0, 0, 0, 0)
omega_0_10 <- (diag(10))
omega_0_10 <- (diag(c(4,1 ,1 , 0.1, 0.1, 0.1, 0.1, 0.1, 0.1),11))
omega_0_10 <- (diag(c(4,1 ,1 , 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1),11))
View(omega_0_10)
u_10
omega_0_10
